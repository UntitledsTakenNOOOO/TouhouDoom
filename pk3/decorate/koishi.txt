ACTOR Koishi 31238
{
//$Category "Touhou Characters"
  Tag "Koishi Komeiji"
  Speed 6
  FastSpeed 12
  MONSTER
  Health 2400
  Radius 24
  Height 64
  Scale 0.7
  MinMissileChance 160
  Mass 1000000
  MeleeThreshold 96
  MeleeRange 48
  DamageFactor "KoishiDamage", 0
  Species "Koishi" //Yeah, she's her own species.
  +NORADIUSDMG //Despite the fact she, in fact, actually has a canon species.
  +DONTRIP
  +LOOKALLAROUND
  +FLOORCLIP
  +BOSS
  +NEVERRESPAWN
  +NORADIUSDMG
  +DONTMORPH
  +DONTRIP
  +MISSILEMORE
  +AMBUSH
  +NOICEDEATH
  Painchance 1
  Seesound ""
  Deathsound "touhou/defeat"
  Painsound "touhou/pain"
  Obituary "%o's subconscious was made clear by Koishi."
  HitObituary "%o totally almost saw that one coming, but was instead one-shotted by Koishi, heavyweight boxing champion."
  DropItem "KoishiDanmakuParanoia"
  States
  {
  Spawn:
	KOIS A 0
    KOIS A 1 ACS_NamedExecute("BHI_BossStartAttack",0,21,9,false)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartTimer",0,21,60)
	KOIS A 1 A_Look
  Idle:
    KOIS BCDEFGHIJA 3 A_Look
    Loop
  See:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Pain:
    KOIS O 0 A_Pain
    KOIS OPQPO 3
    Goto See
  Melee:
	KOIA A 0 A_Playsound("Koishi/meleewarn", 0, 1, 0, ATTN_NONE)
	KOIA ABCD 4 A_FaceTarget
	KOIA C 0 A_CustomMeleeAttack(9999999,"Koishi/meleehit")
	KOIA EFGH 4 A_FaceTarget //Koishi, Heavyweight Boxing Champion
	Goto See //You totally almost saw that one coming.
  Missile:
    KOIA IJKL 5 Fast A_Facetarget
	KOIA M 35 Fast A_SpawnItemEx("KoishiNS1BulletSpawner1",0,0,0,0,0,0,0,0,0)
    KOIA IJKL 5 Fast A_Facetarget
	KOIA M 35 Fast A_SpawnItemEx("KoishiNS1BulletSpawner2",0,0,0,0,0,0,0,0,0)
	Goto See
  Death:
	KOIS O 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	KOIS O 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 A_PlaySound("touhou/nuefire")
	KOIS OOOOOOOOOO 2 A_FadeOut(0.1)
	Stop
  }
}
ACTOR ArchvileFirex : ArchvileFire
{
	Speed 5
    +NOBLOCKMAP
    +NOCLIP
	+NOGRAVITY
}
ACTOR KoishiNS1Bullet1
{
  Radius 2
  Speed 10
  fastspeed 15
  Height 4
  damage (10)
  Projectile
  -ACTIVATEIMPACT
  -ACTIVATEPCROSS
  +strifedamage
  RenderStyle Add
  DeathSound "touhou/hit"
  DamageType "KoishiDamage"
  States
  {
  Spawn:
    GRIC A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    GRIC AAAAAAAAAA 1 A_FadeOut
    Stop
  }
}
ACTOR KoishiNS1Bullet2 : KoishiNS1Bullet1
{
  States
  {
  Spawn:
    BRIC A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    BRIC AAAAAAAAAA 1 A_FadeOut
    Stop
  }
}
ACTOR KoishiNS1BulletSpawner1
{
  RenderStyle "Add"
  +MISSILE
  +NOINTERACTION

  var int user_dist;
  var int user_height;
  var int user_angle;

  States
  {
  Spawn:
    TNT1 A 0
    TNT1 A 0 Bright A_SetUserVar("user_height", 12)
  LoopState:
    TNT1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    TNT1 A 0 Bright A_JumpIfInventory("EnemyCounter1",20,"Death")
    TNT1 A 0 Bright A_GiveInventory("EnemyCounter1",1)
    TNT1 A 0 Bright A_PlaySound("touhou/fire",0,0.7,0,ATTN_NORM)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+0,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+30,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+60,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+90,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+120,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+150,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+180,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+210,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+240,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+270,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+300,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet1",0,0,user_angle+330,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 2 Bright A_Warp(AAPTR_TARGET, user_dist, 0, user_height, user_angle, WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE)
    TNT1 A 0 Bright A_SetUserVar("user_dist", user_dist + 32)
    TNT1 A 0 Bright A_SetUserVar("user_height", user_height + 2)
    TNT1 A 0 Bright A_SetUserVar("user_angle", user_angle + 18)
    Loop
  Death:
    TNT1 A 1
    Stop
  }
}
ACTOR KoishiNS1BulletSpawner2
{
  RenderStyle "Add"
  +MISSILE
  +NOINTERACTION

  var int user_dist;
  var int user_height;
  var int user_angle;

  States
  {
  Spawn:
    TNT1 A 0
    TNT1 A 0 Bright A_SetUserVar("user_height", 12)
  LoopState:
    TNT1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    TNT1 A 0 Bright A_JumpIfInventory("EnemyCounter1",20,"Death")
    TNT1 A 0 Bright A_GiveInventory("EnemyCounter1",1)
    TNT1 A 0 Bright A_PlaySound("touhou/fire",0,0.7,0,ATTN_NORM)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+0,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+30,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+60,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+90,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+120,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+150,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+180,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+210,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+240,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+270,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+300,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS1Bullet2",0,0,user_angle+330,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 2 Bright A_Warp(AAPTR_TARGET, user_dist, 0, user_height, user_angle, WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE)
    TNT1 A 0 Bright A_SetUserVar("user_dist", user_dist + 32)
    TNT1 A 0 Bright A_SetUserVar("user_height", user_height + 2)
    TNT1 A 0 Bright A_SetUserVar("user_angle", user_angle - 18)
    Loop
  Death:
    TNT1 A 1
    Stop
  }
}

ACTOR KoishiDanmakuParanoia : Koishi
{
  +INVULNERABLE
  +NOPAIN
  Health 3200
  MinMissileChance 0
  DropItem "KoishiNS2"
  DamageFactor "PlayerSpellcard", 0
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6133)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6133,9,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6133,90)
	KOIA A 0 ACS_Execute(602,0,69)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA NOPQ 5 A_FaceTarget
  MissileLoop:
	KOIA A 0 A_FaceTarget
	KOIA RRRRRRSSSSSS 1 A_CustomBulletAttack(0,0,1,0,"KoishiParanoiaPuff")
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-48)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-40)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-32)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-24)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-16)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-8)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,0)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,8)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,16)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,24)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,32)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,40)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,48)
	KOIA A 0 A_FaceTarget
	KOIA RRRRRRSSSSSS 1 A_CustomBulletAttack(0,0,1,0,"KoishiParanoiaPuff")
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-44)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-36)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-28)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-20)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-12)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,-4)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,4)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,12)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,20)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,28)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,36)
	KOIA A 0 A_CustomMissile("KoishiDanmakuParanoiaBullet",32,0,44)
	Loop
  Death:
	KOIS O 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	KOIS O 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	KOIS O 0 ACS_Execute(603,0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 A_PlaySound("touhou/nuefire")
	KOIS OOOOOOOOOO 2 A_FadeOut(0.1)
	Stop
  }
}
ACTOR KoishiDanmakuParanoiaBullet
{
  Radius 4
  Speed 5
  fastspeed 10
  Height 8
  damage (20)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  Scale 1.5
  SeeSound "touhou/fire"
  DeathSound "touhou/hit2"
  States
  {
  Spawn:
	BBL3 A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    BBL3 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiParanoiaPuff : BulletPuff
{
  +NOBLOCKMAP
  +NOGRAVITY
  +ALWAYSPUFF
  +PUFFONACTORS
  +PUFFGETSOWNER
  +BLOODLESSIMPACT
  VSpeed 0
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 AAAAAAAA 0 A_SpawnItemEx("KoishiParanoiaPhantom",random(64,128),random(64,128),random(-32,32),0,0,0,frandom(0,360),SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE,0)
	Stop
  }
}
ACTOR KoishiParanoiaPhantom
{
  DamageType "KoishiDamage"
  Radius 2
  Height 4
  Speed 0
  FastSpeed 0
  damage (20)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  XScale 3.0
  YScale 2.0
  Alpha 0.75
  SeeSound "touhou/fire"
  States
  {
  Spawn:
	VKUN A 0
	VKUN A 0 A_SetAngle(random(0,360))
  LoopState:
	VKUN A 4 Bright A_FadeOut(0.15)
    Loop
  Death:
    VKUN AAAAAAAAAA 1 Bright A_FadeOut(0.15)
    Stop
  }
}

ACTOR KoishiNS2 : Koishi
{
  DropItem "KoishiReleaseOfTheIdSoftware" //I'm sorry
  var int user_angle;
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
	KOIS A 1 Thing_ChangeTID(0,6134)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartAttack",0,6134,8,false)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartTimer",0,6134,60)
    KOIS BCDEFGHIJ 3 A_Look
    Loop
  See:
	TNT1 A 0 Thing_ChangeTID(0,6134)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6134,8,false)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6134,60)
	KOIA A 0 A_SetTranslucent(1.0,0)
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA IJ 4 Fast
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+336,CMF_AIMDIRECTION)
	KOIA K 1 A_SetUserVar("user_angle",user_angle+2)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+336,CMF_AIMDIRECTION)
	KOIA K 1 A_SetUserVar("user_angle",user_angle+2)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+336,CMF_AIMDIRECTION)
	KOIA L 1 A_SetUserVar("user_angle",user_angle+2)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+336,CMF_AIMDIRECTION)
	KOIA L 1 A_SetUserVar("user_angle",user_angle+2)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS2Bullet",32,0,user_angle+336,CMF_AIMDIRECTION)
	KOIA M 1 A_SetUserVar("user_angle",user_angle+2)
	KOIA M 1 A_SetUserVar("user_angle",user_angle-20)
	Loop
  }
}
ACTOR KoishiNS2Bullet
{
  Radius 2
  Height 4
  Speed 10
  FastSPeed 20
  damage (10)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  SeeSound "touhou/fire"
  States
  {
  Spawn:
	RRIC A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    RRIC AAAAAAAAAA 1 A_FadeOut
    Stop
  }
}

ACTOR KoishiReleaseOfTheIdSoftware : Koishi //I'm not actually sorry at all
{
  +INVULNERABLE
  +NOPAIN
  Health 2800
  MinMissileChance 0
  DropItem "KoishiNS3"
  DamageFactor "PlayerSpellcard", 0
  var int user_angle;
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6135)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6135,8,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6135,90)
	KOIA A 0 ACS_Execute(602,0,70)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA NOPQ 5 A_FaceTarget
  MissileLoop:
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,30+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,60+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,90+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,120+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,150+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,180+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,210+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,240+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,270+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,300+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart1",32,0,330+user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,30-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,60-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,90-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,120-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,150-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,180-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,210-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,240-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,270-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,300-user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiReleaseOfTheIdHeart2",32,0,330-user_angle,CMF_AIMDIRECTION)
	KOIA R 6 Fast A_SetUserVar("user_angle",user_angle+6)
	KOIA S 6 Fast A_FaceTarget
	Loop
  Death:
	KOIS O 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	KOIS O 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	KOIS O 0 ACS_Execute(603,0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 A_PlaySound("touhou/nuefire")
	KOIS OOOOOOOOOO 2 A_FadeOut(0.1)
	Stop
  }
}
ACTOR KoishiReleaseOfTheIdHeart1
{
  Radius 2
  Speed 12
  fastspeed 24
  Height 4
  damage (10)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit2"
  States
  {
  Spawn:
	VHRT A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	TNT1 A 0 Bright A_SetAngle(angle-1)
	TNT1 A 0 Bright A_ChangeVelocity(1, -1, 0, CVF_RELATIVE)
	TNT1 A 0 Bright A_ScaleVelocity(0.9)
    Loop
  Death:
    RHRT AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiReleaseOfTheIdHeart2
{
  Radius 2
  Speed 12
  fastspeed 24
  Height 4
  damage (10)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit2"
  States
  {
  Spawn:
	RHRT A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	TNT1 A 0 Bright A_SetAngle(angle+1)
	TNT1 A 0 Bright A_ChangeVelocity(1, 1, 0, CVF_RELATIVE)
	TNT1 A 0 Bright A_ScaleVelocity(0.9)
    Loop
  Death:
    VHRT AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}

ACTOR KoishiNS3 : Koishi
{
  DropItem "KoishiEmbersOfLove"
  var int user_angle;
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
	KOIS A 1 Thing_ChangeTID(0,6136)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartAttack",0,6136,7,false)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartTimer",0,6136,60)
    KOIS BCDEFGHIJ 3 A_Look
    Loop
  See:
	TNT1 A 0 Thing_ChangeTID(0,6136)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6136,7,false)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6136,60)
	KOIA A 0 A_SetTranslucent(1.0,0)
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA IJ 4 Fast
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-336,CMF_AIMDIRECTION)
	KOIA K 1 A_SetUserVar("user_angle",user_angle-2)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-336,CMF_AIMDIRECTION)
	KOIA K 1 A_SetUserVar("user_angle",user_angle-2)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-336,CMF_AIMDIRECTION)
	KOIA L 1 A_SetUserVar("user_angle",user_angle-2)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-336,CMF_AIMDIRECTION)
	KOIA L 1 A_SetUserVar("user_angle",user_angle-2)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-24,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-48,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-72,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-96,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-120,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-144,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-168,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-192,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-216,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-240,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-264,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-288,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-312,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiNS3Bullet",32,0,user_angle-336,CMF_AIMDIRECTION)
	KOIA M 1 A_SetUserVar("user_angle",user_angle-2)
	KOIA M 1 A_SetUserVar("user_angle",user_angle+20)
	Loop
  }
}
ACTOR KoishiNS3Bullet
{
  Radius 2
  Height 4
  Speed 10
  FastSPeed 20
  damage (10)
  Scale 2.0
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  SeeSound "touhou/fire"
  States
  {
  Spawn:
	RRIC A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    RRIC AAAAAAAAAA 1 A_FadeOut
    Stop
  }
}

ACTOR KoishiEmbersOfLove : Koishi
{
  +INVULNERABLE
  +NOPAIN
  Health 3300
  DropItem "KoishiNS4"
  DamageFactor "PlayerSpellcard", 0
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6137)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6137,7,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6137,105)
	KOIA A 0 ACS_Execute(602,0,71)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA A 0 A_Jump(128,"Missile2","Missile3")
  Missile1:
    KOIA IJKL 5 A_Facetarget
	KOIA A 0 A_CustomMissile("KoishiEmbersOfLoveHeart",32,64,0,CMF_ABSOLUTEPITCH,0)
	KOIA A 0 A_CustomMissile("KoishiEmbersOfLoveHeart",32,-64,0,CMF_ABSOLUTEPITCH,0)
    KOIA M 20 A_Facetarget
	KOIA A 0 A_Jump(128,"Missile2","Missile3")
	Goto See
  Missile2:
    KOIA ABCD 5 A_Facetarget
	KOIA A 0 A_CustomMissile("KoishiEmbersOfLoveHeart",32,64,75,CMF_ABSOLUTEPITCH,0)
	KOIA A 0 A_CustomMissile("KoishiEmbersOfLoveHeart",32,-64,-75,CMF_ABSOLUTEPITCH,0)
    KOIA EFGH 5 A_Facetarget
	KOIA A 0 A_Jump(128,"Missile1","Missile3")
	Goto See
  Missile3:
	KOIA NOPQ 5 A_FaceTarget
	KOIA A 0 A_CustomMissile("KoishiEmbersOfLoveHeart",32,64,-75,CMF_ABSOLUTEPITCH,0)
	KOIA A 0 A_CustomMissile("KoishiEmbersOfLoveHeart",32,-64,75,CMF_ABSOLUTEPITCH,0)
	KOIA RSTU 5 A_FaceTarget
	KOIA A 0 A_Jump(128,"Missile1","Missile2")
	Goto See
  Death:
	KOIS O 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	KOIS O 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	KOIS O 0 ACS_Execute(603,0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 A_PlaySound("touhou/nuefire")
	KOIS OOOOOOOOOO 2 A_FadeOut(0.1)
	Stop
  }
}
ACTOR KoishiEmbersOfLoveHeart
{
  Radius 2
  Speed 8
  fastspeed 16
  Height 4
  damage (0)
  DamageType "KoishiDamage"
  Projectile
  +RIPPER
  +FORCEXYBILLBOARD
  +HEXENBOUNCE
  BounceFactor 1.0
  BounceCount 20 //Yeah you don't want to let this go on too long
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit2"
  States
  {
  Spawn:
	VHRT A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	TNT1 AA 0 Bright A_SpawnItemEx("KoishiEmbersOfLoveTrail1",frandom(-4,4),frandom(-4,4),frandom(-4,4),0,0,0,0,0,0)
	TNT1 AA 0 Bright A_SpawnItemEx("KoishiEmbersOfLoveTrail2",frandom(-4,4),frandom(-4,4),frandom(-4,4),0,0,0,0,0,0)
	TNT1 A 0 Bright A_SpawnItemEx("KoishiEmbersOfLoveExploder",0,0,0,0,0,0,0,0,0)
    Loop
  Death:
    RHRT AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiEmbersOfLoveExploder
{
  +NOGRAVITY
  +NOINTERACTION
  RenderStyle Add
  DamageType "KoishiDamage"
  States
  {
  Spawn:
	TNT1 AAAAAAAAAAAAAAAA 1 Bright A_Explode(4,4,0,0,4)
    Stop
  }
}
ACTOR KoishiEmbersOfLoveTrail1
{
  +NOGRAVITY
  +NOINTERACTION
  +CLIENTSIDEONLY
  RenderStyle Add
  States
  {
  Spawn:
	BBL4 AAAAAAAAAAAAAAAA 1 Bright
    BBL4 AAAAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiEmbersOfLoveTrail2
{
  +NOGRAVITY
  +NOINTERACTION
  +CLIENTSIDEONLY
  RenderStyle Add
  States
  {
  Spawn:
	RBL4 AAAAAAAAAAAAAAAA 1 Bright
    RBL4 AAAAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}

ACTOR KoishiNS4 : Koishi
{
  DropItem "KoishiGeneticsOfTheSubconscious"
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
	KOIS A 1 Thing_ChangeTID(0,6138)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartAttack",0,6138,6,false)
	KOIS A 1 ACS_NamedExecute("BHI_BossStartTimer",0,6138,60)
    KOIS BCDEFGHIJ 3 A_Look
    Loop
  See:
	TNT1 A 0 Thing_ChangeTID(0,6138)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6138,6,false)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6138,60)
	KOIA A 0 A_SetTranslucent(1.0,0)
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
    KOIA IJKL 5 Fast A_Facetarget
	KOIA M 15 Fast A_SpawnItemEx("KoishiNS4BulletSpawner1",0,0,0,0,0,0,0,0,0)
    KOIA IJKL 5 Fast A_Facetarget
	KOIA M 55 Fast A_SpawnItemEx("KoishiNS4BulletSpawner2",0,0,0,0,0,0,0,0,0)
	Goto See
  }
}
ACTOR KoishiNS4Bullet1
{
  Radius 2
  Speed 10
  fastspeed 15
  Height 4
  damage (10)
  Projectile
  -ACTIVATEIMPACT
  -ACTIVATEPCROSS
  +strifedamage
  RenderStyle Add
  DeathSound "touhou/hit"
  DamageType "KoishiDamage"
  States
  {
  Spawn:
    ORIC A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    ORIC AAAAAAAAAA 1 A_FadeOut
    Stop
  }
}
ACTOR KoishiNS4Bullet2 : KoishiNS4Bullet1
{
  States
  {
  Spawn:
    RRIC A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    RRIC AAAAAAAAAA 1 A_FadeOut
    Stop
  }
}
ACTOR KoishiNS4BulletSpawner1
{
  RenderStyle "Add"
  +MISSILE
  +NOINTERACTION

  var int user_dist;
  var int user_height;
  var int user_angle;

  States
  {
  Spawn:
    TNT1 A 0
    TNT1 A 0 Bright A_SetUserVar("user_height", 12)
  LoopState:
    TNT1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    TNT1 A 0 Bright A_JumpIfInventory("EnemyCounter1",20,"Death")
    TNT1 A 0 Bright A_GiveInventory("EnemyCounter1",1)
    TNT1 A 0 Bright A_PlaySound("touhou/fire",0,0.7,0,ATTN_NORM)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+0,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+30,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+60,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+90,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+120,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+150,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+180,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+210,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+240,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+270,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+300,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet1",0,0,user_angle+330,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 2 Bright A_Warp(AAPTR_TARGET, user_dist, 0, user_height, user_angle, WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE)
    TNT1 A 0 Bright A_SetUserVar("user_dist", user_dist + 32)
    TNT1 A 0 Bright A_SetUserVar("user_height", user_height + 2)
    TNT1 A 0 Bright A_SetUserVar("user_angle", user_angle + 18)
    Loop
  Death:
    TNT1 A 1
    Stop
  }
}
ACTOR KoishiNS4BulletSpawner2
{
  RenderStyle "Add"
  +MISSILE
  +NOINTERACTION

  var int user_dist;
  var int user_height;
  var int user_angle;

  States
  {
  Spawn:
    TNT1 A 0
    TNT1 A 0 Bright A_SetUserVar("user_height", 12)
  LoopState:
    TNT1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    TNT1 A 0 Bright A_JumpIfInventory("EnemyCounter1",20,"Death")
    TNT1 A 0 Bright A_GiveInventory("EnemyCounter1",1)
    TNT1 A 0 Bright A_PlaySound("touhou/fire",0,0.7,0,ATTN_NORM)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+0,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+30,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+60,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+90,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+120,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+150,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+180,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+210,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+240,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+270,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+300,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 0 Bright A_CustomMissile("KoishiNS4Bullet2",0,0,user_angle+330,CMF_AIMDIRECTION|CMF_TRACKOWNER,0)
    TNT1 A 2 Bright A_Warp(AAPTR_TARGET, user_dist, 0, user_height, user_angle, WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE)
    TNT1 A 0 Bright A_SetUserVar("user_dist", user_dist + 32)
    TNT1 A 0 Bright A_SetUserVar("user_height", user_height + 2)
    TNT1 A 0 Bright A_SetUserVar("user_angle", user_angle - 18)
    Loop
  Death:
    TNT1 A 1
    Stop
  }
}

ACTOR KoishiGeneticsOfTheSubconscious : Koishi
{
  +INVULNERABLE
  +NOPAIN
  Health 3000
  DropItem "None"
  DamageFactor "PlayerSpellcard", 0
  MinMissileChance 0
  var int user_height;
  var int user_dist;
  var int user_angle;
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6139)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6139,6,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6139,110)
	KOIA A 0 ACS_Execute(602,0,72)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA A 0 A_SetUserVar("user_height",90)
	KOIA A 0 A_SetUserVar("user_dist",0)
	KOIA A 0 A_SetUserVar("user_angle",0)
    KOIA NOPQ 5 Fast A_FaceTarget
  MissileLoop: //I'm afraid we'll have to use...MATH!
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA R 1 A_Chase("","",CHF_NIGHTMAREFAST)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA R 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA R 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA R 1 A_Chase("","",CHF_NIGHTMAREFAST)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA R 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA R 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA S 1 A_Chase("","",CHF_NIGHTMAREFAST)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA S 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA S 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA S 1 A_Chase("","",CHF_NIGHTMAREFAST)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA S 1 A_Wander
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet1",sin(user_height)*24+32,cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_CustomMissile("KoishiGeneticsBullet2",-sin(user_height)*24+32,-cos(user_dist)*192,user_angle,CMF_AIMDIRECTION)
	KOIA A 0 A_SetUserVar("user_height",user_height+12)
	KOIA A 0 A_SetUserVar("user_dist",user_dist+9)
	KOIA A 0 A_SetUserVar("user_angle",user_angle+6)
	KOIA S 1 A_Wander
	Loop
  Death:
	KOIS O 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	KOIS O 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	KOIS O 0 ACS_Execute(603,0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
	KOIS OPQ 15
	KOIS O 0 A_ScreamAndUnblock
	TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 BRIGHT A_SpawnItemEx("TouhouFireWhite",frandom(4,-4),frandom(4,-4),frandom(4,-4),frandom(8,-8),frandom(8,-8),frandom(8,-8),frandom(0,360),0,0)
	TNT1 A 105
	TNT1 A 0 ACS_Execute(54,0)
	Stop
  }
}
ACTOR KoishiGeneticsBullet1
{
  Radius 2
  Speed 0
  fastspeed 0
  Height 4
  damage (10)
  Projectile
  -ACTIVATEIMPACT
  -ACTIVATEPCROSS
  RenderStyle Add
  DeathSound "touhou/hit"
  DamageType "KoishiDamage"
  States
  {
  Spawn:
    GBL1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    GBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    GBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
  LoopState:
    GBL1 A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	Loop
  Death:
    GBL1 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiGeneticsBullet2
{
  Radius 2
  Speed 0
  fastspeed 0
  Height 4
  damage (10)
  Projectile
  -ACTIVATEIMPACT
  -ACTIVATEPCROSS
  RenderStyle Add
  DeathSound "touhou/hit"
  DamageType "KoishiDamage"
  States
  {
  Spawn:
    BBL1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
    BBL1 A 0 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    BBL1 A 1 Bright ThrustThing(angle*256/360, 1, 0, 0)
  LoopState:
    BBL1 A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	Loop
  Death:
    BBL1 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}

ACTOR KoishiDekwSign : Koishi
{
  +INVULNERABLE
  +NOPAIN
  Health 3000
  DropItem "None"
  DamageFactor "PlayerSpellcard", 0
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	KOIA A 0 ACS_Execute(602,0,74)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartKoishiTimer",0,90)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
    KOIA IJKL 6 Fast A_Facetarget
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,5)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,15)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,25)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,35)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,45)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,55)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,65)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,75)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,85)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,95)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,105)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,115)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,125)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,135)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,145)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,155)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,165)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,175)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,185)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,195)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,205)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,215)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,225)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,235)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,245)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,255)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,265)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,275)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,285)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,295)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,305)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,315)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,325)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,335)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,345)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,355)
    KOIA M 12 Fast A_Facetarget
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,5)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,15)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,25)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,35)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,45)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,55)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,65)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,75)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,85)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,95)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,105)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,115)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,125)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,135)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,145)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,155)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,165)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,175)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,185)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,195)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,205)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,215)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,225)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,235)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,245)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,255)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,265)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,275)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,285)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,295)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,305)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,315)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,325)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,335)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,345)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,355)
    KOIA M 12 Fast A_Facetarget
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,5)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,15)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,25)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,35)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,45)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,55)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,65)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,75)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,85)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,95)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,105)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,115)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,125)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,135)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,145)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,155)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,165)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,175)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,185)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,195)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,205)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,215)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,225)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,235)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,245)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,255)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,265)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,275)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,285)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,295)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,305)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,315)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,325)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,335)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,345)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,355)
    KOIA M 12 Fast A_Facetarget
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,5)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,15)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,25)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,35)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,45)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,55)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,65)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,75)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,85)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,95)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,105)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,115)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,125)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,135)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,145)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,155)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,165)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,175)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,185)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,195)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,205)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,215)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,225)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,235)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,245)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,255)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,265)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,275)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,285)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,295)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,305)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,315)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,325)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,335)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,345)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,355)
    KOIA M 12 Fast A_Facetarget
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,5)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,15)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,25)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,35)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,45)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,55)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,65)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,75)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,85)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,95)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,105)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,115)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,125)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,135)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,145)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,155)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,165)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,175)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,185)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,195)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,205)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,215)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,225)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,235)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,245)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,255)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,265)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,275)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,285)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,295)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,305)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,315)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,325)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,335)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,345)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,355)
    KOIA M 12 Fast A_Facetarget
	Goto See
  Death:
	KOIS O 0 ACS_Execute(603,0)
	TNT1 A 0 ACS_NamedTerminate("BHI_BossStartKoishiTimer",0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 A_PlaySound("touhou/nuefire")
	TNT1 A 0 ACS_Execute(56,0)
	KOIS OOOOOOOOOO 2 A_FadeOut(0.1)
	Stop
  }
}
ACTOR KoishiDekwBullet
{
  Radius 2
  Speed 10
  FastSpeed 20
  Height 4
  damage (20)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit"
  States
  {
  Spawn:
	BBL1 A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    BBL1 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}

//Just F.Y.I. Yholl, in case you're reading this
//I did in fact have A_SetScale, just for you!
ACTOR KoishiYhollSign : Koishi
{
  +INVULNERABLE
  +NOPAIN
  Health 3000
  DropItem "KoishiUntitledSign"
  DamageFactor "PlayerSpellcard", 0
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	KOIA A 0 ACS_Execute(602,0,75)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartKoishiTimer",0,90)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
    KOIA NOPQ 6 Fast A_Facetarget
	KOIA A 0 A_PlaySound("touhou/charge3",0,1.0,0,ATTN_NONE)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect01",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect02",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect03",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect04",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect05",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect06",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect07",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect08",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect09",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect10",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect11",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect12",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect13",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect14",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect15",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect16",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect17",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect18",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect19",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect20",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect21",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect22",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect23",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect24",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect25",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect26",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect27",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect28",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect29",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect30",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect31",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect32",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect33",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect34",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect35",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect36",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect37",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect38",0,0,128,0,0,0,0,0,0)
    KOIA R 2 Fast A_SpawnItemEx("KoishiYhollSignEffect39",0,0,128,0,0,0,0,0,0)
    KOIA S 2 Fast A_SpawnItemEx("KoishiYhollSignEffect40",0,0,128,0,0,0,0,0,0)
	KOIA RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR 0 A_CustomMissile("KoishiYhollSignBulletY",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS 0 A_CustomMissile("KoishiYhollSignBulletG",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR 0 A_CustomMissile("KoishiYhollSignBulletC",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS 0 A_CustomMissile("KoishiYhollSignBulletB",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR 0 A_CustomMissile("KoishiYhollSignBulletV",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS 0 A_CustomMissile("KoishiYhollSignBulletR",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT 0 A_CustomMissile("KoishiYhollSignBulletS",128,0,frandom(0,360),CMF_AIMDIRECTION,frandom(-90,90))
	KOIA TU 6 Fast A_FaceTarget
	Goto See
  Death:
	KOIS O 0 ACS_Execute(603,0)
	TNT1 A 0 ACS_NamedTerminate("BHI_BossStartKoishiTimer",0)
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 A_PlaySound("touhou/nuefire")
	KOIS OOOOOOOOOO 2 A_FadeOut(0.1)
	Stop
  }
}
ACTOR KoishiYhollSignEffect01
{
  Speed 0
  FastSpeed 0
  Radius 2
  Height 4
  damage (0)
  Projectile
  +FORCEXYBILLBOARD
  +NOINTERACTION
  +CLIENTSIDEONLY
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit"
  Scale 0.1
  States
  {
  Spawn:
	WHRT A 0 Bright
	WHRT A 2 Bright
    Stop
  }
}
//JUST FOR YOU, YHOLL
//JUST FOR YOU
ACTOR KoishiYhollSignEffect02 : KoishiYhollSignEffect01 { Scale 0.2 }
ACTOR KoishiYhollSignEffect03 : KoishiYhollSignEffect01 { Scale 0.3 }
ACTOR KoishiYhollSignEffect04 : KoishiYhollSignEffect01 { Scale 0.4 }
ACTOR KoishiYhollSignEffect05 : KoishiYhollSignEffect01 { Scale 0.5 }
ACTOR KoishiYhollSignEffect06 : KoishiYhollSignEffect01 { Scale 0.6 }
ACTOR KoishiYhollSignEffect07 : KoishiYhollSignEffect01 { Scale 0.7 }
ACTOR KoishiYhollSignEffect08 : KoishiYhollSignEffect01 { Scale 0.8 }
ACTOR KoishiYhollSignEffect09 : KoishiYhollSignEffect01 { Scale 0.9 }
ACTOR KoishiYhollSignEffect10 : KoishiYhollSignEffect01 { Scale 1.0 }
ACTOR KoishiYhollSignEffect11 : KoishiYhollSignEffect01 { Scale 1.1 }
ACTOR KoishiYhollSignEffect12 : KoishiYhollSignEffect01 { Scale 1.2 }
ACTOR KoishiYhollSignEffect13 : KoishiYhollSignEffect01 { Scale 1.3 }
ACTOR KoishiYhollSignEffect14 : KoishiYhollSignEffect01 { Scale 1.4 }
ACTOR KoishiYhollSignEffect15 : KoishiYhollSignEffect01 { Scale 1.5 }
ACTOR KoishiYhollSignEffect16 : KoishiYhollSignEffect01 { Scale 1.6 }
ACTOR KoishiYhollSignEffect17 : KoishiYhollSignEffect01 { Scale 1.7 }
ACTOR KoishiYhollSignEffect18 : KoishiYhollSignEffect01 { Scale 1.8 }
ACTOR KoishiYhollSignEffect19 : KoishiYhollSignEffect01 { Scale 1.9 }
ACTOR KoishiYhollSignEffect20 : KoishiYhollSignEffect01 { Scale 2.0 }
ACTOR KoishiYhollSignEffect21 : KoishiYhollSignEffect01 { Scale 2.1 }
ACTOR KoishiYhollSignEffect22 : KoishiYhollSignEffect01 { Scale 2.2 }
ACTOR KoishiYhollSignEffect23 : KoishiYhollSignEffect01 { Scale 2.3 }
ACTOR KoishiYhollSignEffect24 : KoishiYhollSignEffect01 { Scale 2.4 }
ACTOR KoishiYhollSignEffect25 : KoishiYhollSignEffect01 { Scale 2.5 }
ACTOR KoishiYhollSignEffect26 : KoishiYhollSignEffect01 { Scale 2.6 }
ACTOR KoishiYhollSignEffect27 : KoishiYhollSignEffect01 { Scale 2.7 }
ACTOR KoishiYhollSignEffect28 : KoishiYhollSignEffect01 { Scale 2.8 }
ACTOR KoishiYhollSignEffect29 : KoishiYhollSignEffect01 { Scale 2.9 }
ACTOR KoishiYhollSignEffect30 : KoishiYhollSignEffect01 { Scale 3.0 }
ACTOR KoishiYhollSignEffect31 : KoishiYhollSignEffect01 { Scale 3.1 }
ACTOR KoishiYhollSignEffect32 : KoishiYhollSignEffect01 { Scale 3.2 }
ACTOR KoishiYhollSignEffect33 : KoishiYhollSignEffect01 { Scale 3.3 }
ACTOR KoishiYhollSignEffect34 : KoishiYhollSignEffect01 { Scale 3.4 }
ACTOR KoishiYhollSignEffect35 : KoishiYhollSignEffect01 { Scale 3.5 }
ACTOR KoishiYhollSignEffect36 : KoishiYhollSignEffect01 { Scale 3.6 }
ACTOR KoishiYhollSignEffect37 : KoishiYhollSignEffect01 { Scale 3.7 }
ACTOR KoishiYhollSignEffect38 : KoishiYhollSignEffect01 { Scale 3.8 }
ACTOR KoishiYhollSignEffect39 : KoishiYhollSignEffect01 { Scale 3.9 }
ACTOR KoishiYhollSignEffect40 : KoishiYhollSignEffect01 { Scale 4.0 }
ACTOR KoishiYhollSignBulletY
{
  Speed 50
  FastSpeed 60
  Radius 4
  Height 8
  damage (20)
  Projectile
  +FORCEXYBILLBOARD
  -NOGRAVITY
  BounceType "Doom"
  BounceCount 3
  RenderStyle Add
  DeathSound "touhou/hit2"
  States
  {
  Spawn:
	TNT1 A 0 //Yes Yholl
	TNT1 A 0 Bright A_SetScale(1.0) //I DID have A_SetScale
	YHRT A 0 Bright A_ScaleVelocity(frandom(0.1,1.0))
	Goto LoopState
  LoopState:
    "####" A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
    Loop
  Death:
    "####" AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiYhollSignBulletG : KoishiYhollSignBulletY
{
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 Bright A_SetScale(1.0)
	GHRT A 0 Bright A_ScaleVelocity(frandom(0.4,1.0))
	Goto LoopState
  }
}
ACTOR KoishiYhollSignBulletC : KoishiYhollSignBulletY
{
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 Bright A_SetScale(1.0)
	CHRT A 0 Bright A_ScaleVelocity(frandom(0.4,1.0))
	Goto LoopState
  }
}
ACTOR KoishiYhollSignBulletB : KoishiYhollSignBulletY
{
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 Bright A_SetScale(1.0)
	BHRT A 0 Bright A_ScaleVelocity(frandom(0.4,1.0))
	Goto LoopState
  }
}
ACTOR KoishiYhollSignBulletV : KoishiYhollSignBulletY
{
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 Bright A_SetScale(1.0)
	VHRT A 0 Bright A_ScaleVelocity(frandom(0.4,1.0))
	Goto LoopState
  }
}
ACTOR KoishiYhollSignBulletR : KoishiYhollSignBulletY
{
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 Bright A_SetScale(1.0)
	RHRT A 0 Bright A_ScaleVelocity(frandom(0.4,1.0))
	Goto LoopState
  }
}
ACTOR KoishiYhollSignBulletS : KoishiYhollSignBulletY
{
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 Bright A_SetScale(1.0)
	SHRT A 0 Bright A_ScaleVelocity(frandom(0.4,1.0))
	Goto LoopState
  }
}
ACTOR KoishiUntitledSign : Koishi
{
  Speed 18
  FastSpeed 24
  +INVULNERABLE
  +NOPAIN
  Health 3000
  DropItem "None"
  DamageFactor "PlayerSpellcard", 0
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	KOIA A 0 ACS_Execute(602,0,76)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartKoishiTimer",0,90)
	KOIA A 0 ACS_Execute(57,0)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	KOIA A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Melee:
	KOIA A 0 A_Playsound("Koishi/meleewarn", 0, 1, 0, ATTN_NONE)
	KOIA ABCD 4 A_FaceTarget
	KOIA C 0 A_CustomMeleeAttack(9999999,"Koishi/meleehit")
	KOIA EFGH 4 A_FaceTarget //Koishi, Heavyweight Boxing Champion
	Goto See //You totally almost saw that one coming.
  Missile:
	KOIA A 0 A_SkullAttack(20)
	KOIA A 0 A_Playsound("Koishi/meleewarn", 0, 1, 0, ATTN_NORM)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA ABCD 3
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,0)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,10)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,20)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,30)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,40)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,50)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,60)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,70)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,80)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,90)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,100)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,110)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,120)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,130)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,140)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,150)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,160)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,170)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,180)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,190)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,200)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,210)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,220)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,230)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,240)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,250)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,260)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,270)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,280)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,290)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,300)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,310)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,320)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,330)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,340)
	KOIA M 0 A_CustomMissile("KoishiDekwBullet",32,0,350)
	KOIA EFGH 3 A_CustomMeleeAttack(999999,"Koishi/meleehit")
	KOIA A 0 A_Stop
	Goto See
  Death:
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 ACS_Execute(603)
	TNT1 A 0 ACS_NamedTerminate("BHI_BossStartKoishiTimer",0)
    KOIS OPQ 15
	KOIS A 0 A_ScreamAndUnblock
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,0,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,120,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,150,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,180,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-120,2)
    FIRE A 10 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-150,2)
	FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,0,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,120,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,150,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,180,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-120,2)
    FIRE A 10 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-150,2)
	FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,0,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,120,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,150,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,180,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-120,2)
    FIRE A 10 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-150,2)
	TNT1 A 105
	TNT1 A 0 ACS_Execute(58,0)
    Stop
  }
}

ACTOR CandelabraSlayerShooter 31239
{
//$Category "Touhou Characters"
  Radius 16
  Height 56
  Speed 0
  FastSpeed 0
  Damage (0)
  Health 10000
  Monster //?!
  -SOLID
  -COUNTKILL
  -SHOOTABLE
  -CANPUSHWALLS
  -CANUSEWALLS
  -ACTIVATEMCROSS
  +FRIENDLY
  +NOBLOOD
  +FLOAT
  +NOGRAVITY
  +MISSILEMORE
  +DONTFALL
  +NOICEDEATH
  SeeSound ""
  PainSound ""
  AttackSound ""
  MeleeSound ""
  PainChance 256
  States
  {
  Spawn:
    TNT1 A 1 Bright
    Loop
  See:
    TNT1 A 1 Bright
    Loop
  Missile:
	Goto See
  BlueShot:
	TNT1 A 0 Bright A_CustomMissile("CandelabraSlayerShotBlue",32,0,0,CMF_AIMDIRECTION)
	Goto See
  GreenShot:
	TNT1 A 0 Bright A_CustomMissile("CandelabraSlayerShotGreen",32,0,0,CMF_AIMDIRECTION)
	Goto See
  RedShot:
	TNT1 A 0 Bright A_CustomMissile("CandelabraSlayerShotRed",32,0,0,CMF_AIMDIRECTION)
	Goto See
  Pain:
    TNT1 A 6 Bright A_Stop
    Goto See
  Death:
    TNT1 A 6 Bright A_GiveInventory("EnemyCounter2",1)
	TNT1 A 0 Bright A_Stop
    Stop
  }
}
ACTOR CandelabraSlayerShotBlue
{
  Radius 4
  Speed 8
  FastSpeed 16
  Height 64
  damage (10)
  Projectile
  +FORCEXYBILLBOARD
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit"
  States
  {
  Spawn:
    BBL1 A 1 Bright A_JumpIfInTargetInventory("EnemyCounter2",1,"Death")
    Loop
  Death:
    BBL1 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR CandelabraSlayerShotGreen : CandelabraSlayerShotBlue
{
  States
  {
  Spawn:
    GBL1 A 1 Bright A_JumpIfInTargetInventory("EnemyCounter2",1,"Death")
    Loop
  Death:
    GBL1 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR CandelabraSlayerShotRed : CandelabraSlayerShotBlue
{
  States
  {
  Spawn:
    RBL1 A 1 Bright A_JumpIfInTargetInventory("EnemyCounter2",1,"Death")
    Loop
  Death:
    RBL1 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR KoishiPraiseBenellus : Koishi
{
  +INVULNERABLE
  +NOPAIN
  Speed 0
  MinMissileChance 128
  Health 9000
  DamageFactor "PlayerSpellcard", 0
  var int user_spawnshotties;
  var int user_spread;
  Obituary "%o was shotgunned by Koishi."
  DropItem "SoulSphere"
  States
  {
  Spawn:
    KOIS A 0
	KOIS A 3 A_SetTranslucent(0.1)
    KOIS BCDEFGHIJ 3 A_FadeIn(0.1)
  Idle:
    KOIS ABCDEFGHIJ 3 A_Look
    Loop
  See:
	KOIA A 0 A_SetTranslucent(1.0,0)
	KOIA A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    KOIA NOPQ 5 A_FaceTarget
	KOIA A 0 ACS_Execute(60,0)
	KOIA A 0 ACS_Execute(602,0,78)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartKoishiTimer",0,180)
	KOIA A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	KOIA RSRSRSRSRSRS 3 A_FaceTarget
    KOIA TU 5 A_FaceTarget
	KOIA A 0 A_GiveInventory("SpellcardActive",1)
	KOIA A 0 A_UnSetInvulnerable
	Goto Missile
  ChaseState:
    KOIS ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	KOIA NOPQ 6 A_FaceTarget
	KOIA A 0 A_JumpIfHealthLower(3000,"Missile3Loop")
	KOIA A 0 A_JumpIfHealthLower(6000,"Missile2")
	Goto Missile1
  Missile1:
	TNT1 A 0 A_CustomMissile("ShellProjectile1",32,0,0 - 12.0) // One
	TNT1 A 0 A_CustomMissile("ShellProjectile1",32,0,0 + 12.0) // One
	TNT1 A 0 A_CustomMissile("ShellProjectile1Pink",32,0,0 - 64.0) // One
	TNT1 A 0 A_CustomMissile("ShellProjectile1Pink",32,0,0 + 64.0) // One
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile2",32,0,2 - 12.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2",32,0,-2 - 12.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2",32,0,2 + 12.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2",32,0,-2 + 12.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,2 - 64.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,-2 - 64.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,2 + 64.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,-2 + 64.0) // Two
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,4 - 12.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0 - 12.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,-4 - 12.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,4 + 12.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0 + 12.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,-4 + 12.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,4 - 64.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,0 - 64.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,-4 - 64.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,4 + 64.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,0 + 64.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,-4 + 64.0) // Three
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,6 - 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,2 - 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-2 - 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-6 - 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,6 + 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,2 + 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-2 + 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-6 + 12.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,6 - 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,2 - 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-2 - 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-6 - 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,6 + 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,2 + 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-2 + 64.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-6 + 64.0) // Four
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA T 3 Bright
	KOIA U 3
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8 - 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,4 - 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,0 - 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-4 - 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8 - 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8 + 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,4 + 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,0 + 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-4 + 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8 + 12.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,8 - 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,4 - 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,0 - 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-4 - 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-8 - 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,8 + 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,4 + 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,0 + 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-4 + 64.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-8 + 64.0) // Five
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA U 3 Bright
	TNT1 A 0 A_PlaySound("benellus/pump1",7)
	KOIA NOPQ 3

	TNT1 A 0 A_CustomMissile("ShellProjectile1",32,0,0) // One
	TNT1 A 0 A_CustomMissile("ShellProjectile1",32,0,0 - 40.0) // One
	TNT1 A 0 A_CustomMissile("ShellProjectile1",32,0,0 + 40.0) // One
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile2",32,0,2) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2",32,0,-2) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,2 - 40.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,-2 - 40.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,2 + 40.0) // Two
	TNT1 A 0 A_CustomMissile("ShellProjectile2Pink",32,0,-2 + 40.0) // Two
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,4) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,-4) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,4 - 40.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,0 - 40.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,-4 - 40.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,4 + 40.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,0 + 40.0) // Three
	TNT1 A 0 A_CustomMissile("ShellProjectile3Pink",32,0,-4 + 40.0) // Three
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,6) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,2) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-2) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-6) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,6 - 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,2 - 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-2 - 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-6 - 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,6 + 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,2 + 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-2 + 40.0) // Four
	TNT1 A 0 A_CustomMissile("ShellProjectile4Pink",32,0,-6 + 40.0) // Four
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA T 3 Bright
	KOIA U 3
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,4) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-4) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,8 - 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,4 - 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,0 - 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-4 - 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-8 - 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,8 + 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,4 + 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,0 + 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-4 + 40.0) // Five
	TNT1 A 0 A_CustomMissile("ShellProjectile5Pink",32,0,-8 + 40.0) // Five
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA U 3 Bright
	TNT1 A 0 A_PlaySound("benellus/pump1",7)
	KOIA NOPQ 3
	TNT1 A 0 A_SpidReFire
	goto Missile
  Missile2:
	TNT1 A 0 A_JumpIf(user_spawnshotties > 0, "Missile2Loop")
	TNT1 A 0 A_SetUserVar("user_spawnshotties", 1)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter1",32,0,8,0,0,0,0,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter1",32,0,8,0,0,0,90,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter1",32,0,8,0,0,0,180,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter1",32,0,8,0,0,0,270,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter2",32,0,40,0,0,0,0,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter2",32,0,40,0,0,0,90,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter2",32,0,40,0,0,0,180,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter2",32,0,40,0,0,0,270,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter3",32,0,128,0,0,0,0,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter3",0,0,160,0,0,0,0,SXF_NOCHECKPOSITION,0,4132)
	TNT1 A 0 A_SpawnItemEx("ShotgunShooter3",-64,0,128,0,0,0,0,SXF_NOCHECKPOSITION,0,4132)
  Missile2Loop:
	KOIA R 0 A_PlaySoundEx("benellus/fire2",5)
	KOIA R 3 A_JumpIfHealthLower(3000,"Missile3")
	KOIA S 0 A_PlaySoundEx("benellus/fire2",5)
	KOIA S 3 A_JumpIfHealthLower(3000,"Missile3")
	Loop
  Missile3:
	KOIA A 0 A_KillChildren
	KOIA A 0 ACS_Execute(61,0)
	KOIA NOPQ 3
  Missile3Loop:
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,4)
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-4)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8)
	TNT1 A 0 A_SetUserVar("user_spread",user_spread + 16.0)
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,4)
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-4)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8)
	TNT1 A 0 A_SetUserVar("user_spread",user_spread + 16.0)
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,4)
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-4)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8)
	TNT1 A 0 A_SetUserVar("user_spread",user_spread + 16.0)
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,4)
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-4)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8)
	TNT1 A 0 A_SetUserVar("user_spread",user_spread + 16.0)
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	KOIA S 3
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 - user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile3Orange",32,0,0 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile4Orange",32,0,-4 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5Orange",32,0,-8 + user_spread)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,8)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,4)
	TNT1 A 0 A_CustomMissile("ShellProjectile3",32,0,0)
	TNT1 A 0 A_CustomMissile("ShellProjectile4",32,0,-4)
	TNT1 A 0 A_CustomMissile("ShellProjectile5",32,0,-8)
	TNT1 A 0 A_SetUserVar("user_spread",user_spread + 16.0)
	TNT1 A 0 A_PlaySound("benellus/fire1",6)
	KOIA R 3 Bright
	TNT1 A 0 A_PlaySound("benellus/pump1",7)
	KOIA STU 4 A_SetUserVar("user_spread",16)
	TNT1 A 0 A_SpidRefire
	loop
  Death:
	KOIS O 0 A_GiveInventory("BulletDeathTrigger",1)
    KOIS O 0 A_NoBlocking
	KOIS O 0 ACS_Execute(62,0)
	KOIS O 0 ACS_Execute(603,0)
	TNT1 A 0 ACS_NamedTerminate("BHI_BossStartKoishiTimer",0)
    KOIS OPQ 15
	KOIS A 0 A_ScreamAndUnblock
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,0,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,120,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,150,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,180,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-120,2)
    FIRE A 10 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-150,2)
	FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,0,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,120,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,150,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,180,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-120,2)
    FIRE A 10 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-150,2)
	FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,0,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,120,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,150,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,180,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-30,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-60,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-90,2)
    FIRE A 0 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-120,2)
    FIRE A 10 BRIGHT A_CustomMissile("ArchvileFirex",0,0,-150,2)
	TNT1 A 175
	TNT1 A 0 ACS_Execute(63,0)
    Stop
  }
}
actor ShellProjectile1 : FastProjectile
{
    Radius 2
    Height 2
    Speed 35
    Damage (4)
    Scale 0.8
    Projectile
    +RANDOMIZE
    States
    {
    Spawn:
        TNT1 A 0 A_Jump(255,"Spawn1",1,2,3,4,5,6)
        TNT1 A 1
        loop
    Spawn1:
        SHLP ABCDEFG 1 Bright
        Loop
    Death:
        TNT1 A 0 A_SetScale(0.9,0.9)
        BAL1 CDE 3 Bright
        Stop
    }
}
actor ShellProjectile1Pink : ShellProjectile1 { Translation "176:191=16:31", "47:47=36:36" }
actor ShellProjectile2 : ShellProjectile1 { Speed 32 }
actor ShellProjectile2Pink : ShellProjectile2 { Translation "176:191=16:31", "47:47=36:36" }
actor ShellProjectile3 : ShellProjectile1 { Speed 29 }
actor ShellProjectile3Pink : ShellProjectile3 { Translation "176:191=16:31", "47:47=36:36" }
actor ShellProjectile4 : ShellProjectile1 { Speed 26 }
actor ShellProjectile4Pink : ShellProjectile4 { Translation "176:191=16:31", "47:47=36:36" }
actor ShellProjectile5 : ShellProjectile1 { Speed 23 }
actor ShellProjectile5Pink : ShellProjectile5 { Translation "176:191=16:31", "47:47=36:36" }

actor ShellProjectileFast : ShellProjectile1 { Scale 0.6 Speed 40 Translation "176:191=160:167", "47:47=238:238" }
actor ShellProjectileFast2 : ShellProjectileFast { Translation "176:191=112:127", "47:47=127:127" }

actor ShotgunShooter1
{
    -SOLID
    +THRUACTORS
    //+FLOATBOB
    +NOGRAVITY
    Obituary "%o was shotgunned by Koishi."
    States
    {
    Spawn:
        TNT1 A 0
		TNT1 A 0 Thing_ChangeTID(0, 48)
        GSHT A 2 //A_Warp(AAPTR_NULL,0,4,0,4,WARPF_USECALLERANGLE | WARPF_NOCHECKPOSITION | WARPF_INTERPOLATE)
        TNT1 A 0 //A_PlaySoundEx("benellus/fire2",5)
        GSHT B 1 Bright A_CustomMissile("ShellProjectileFast",6,0,0,CMF_AIMDIRECTION,0)
        GSHT A 1 A_SpawnItemEx("ShotgunShooter1",0,1,0,0,0,0,-1,SXF_NOCHECKPOSITION,0,4132)
        stop
    Death:
        TNT1 A 1
        stop
    }
}

actor ShotgunShooter2
{
    -SOLID
    +THRUACTORS
    //+FLOATBOB
    +NOGRAVITY
    Obituary "%o was shotgunned by Koishi."
    States
    {
    Spawn:
        TNT1 A 0
		TNT1 A 0 Thing_ChangeTID(0, 48)
        GSHT A 2 //A_Warp(AAPTR_NULL,0,4,0,4,WARPF_USECALLERANGLE | WARPF_NOCHECKPOSITION | WARPF_INTERPOLATE)
        //TNT1 A 0 A_PlaySoundEx("benellus/fire2",5) // Let's just have the sound playing four times instead of eight
        GSHT B 1 Bright A_CustomMissile("ShellProjectileFast2",6,0,0,CMF_AIMDIRECTION,0)
        GSHT A 1 A_SpawnItemEx("ShotgunShooter2",0,-1,0,0,0,0,1,SXF_NOCHECKPOSITION,0,4132)
        stop
    Death:
        TNT1 A 1
        stop
    }
}

actor ShotgunShooter3
{
    Scale 2.0
    //Health 1000
    //Monster
    -SOLID
    +THRUACTORS
    +FLOATBOB
    +NOGRAVITY
    +LOOKALLAROUND
    +MISSILEMORE
    +MISSILEEVENMORE
    Speed 0
    Obituary "%o was shotgunned by Koishi."
    States
    {
    Spawn:
        TNT1 A 0
		TNT1 A 0 Thing_ChangeTID(0, 48)
        GSHT A 2 A_Look
        loop
    See:
        GSHT A 4 A_Chase
        loop
    Missile:
        TNT1 A 0 A_FaceTarget
        TNT1 A 0 A_PlaySound("benellus/fire3",5)
        TNT1 AAAAAAA 0 A_CustomMissile("ShellProjectile1Brown",12,0,frandom(-18,18),0,0)
        GSHT B 5 Bright
        GSHT A 25
        goto See
    Death:
        TNT1 A 1
        stop
    }
}

actor ShellProjectile1Brown : ShellProjectile1 { Translation "176:191=128:143", "47:47=151:151" }

actor ShellProjectile3Orange : ShellProjectile3 { Translation "176:191=208:223", "47:47=234:234" }
actor ShellProjectile4Orange : ShellProjectile4 { Translation "176:191=208:223", "47:47=234:234" }
actor ShellProjectile5Orange : ShellProjectile5 { Translation "176:191=208:223", "47:47=234:234" }

actor ShotgunShooter4
{
    -SOLID
    +THRUACTORS
    //+FLOATBOB
    +NOGRAVITY
    Obituary "%o was shotgunned by Koishi."
    States
    {
    Spawn:
        TNT1 A 0
        GSHT A 2 A_Look
        loop
    See:
        GSHT A 1 A_Chase
        loop
    Missile:
        TNT1 A 0
        GSHT A 2 A_FaceTarget
        TNT1 A 0 A_PlaySoundEx("benellus/fire2",5)
        GSHT B 1 Bright A_CustomMissile("ShellProjectileFastBlue",6,0,0,0,0)
        TNT1 A 0 A_SpidRefire
        loop
    Death:
        TNT1 A 1
        stop
    }
}

actor ShellProjectileFastBlue : ShellProjectile1 { Scale 0.6 Speed 40 Translation "176:191=192:207", "47:47=240:240" }