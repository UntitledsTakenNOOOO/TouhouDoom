ACTOR ExMarisa : Marisa 31507
{
//$Category "Touhou Characters"
  Tag "Marisa Kirisame"
  Speed 8
  MONSTER
  Health 3000
  Radius 24
  Height 64
  Scale 0.7
  Mass 10000
  MeleeThreshold 64
  MeleeRange 64
  DamageFactor "MarisaDamage", 0
  DamageFactor "PlayerSpellcard", 0.5
  DamageFactor "TouhouHakureiNeedle", 1.4
  MinMissileChance 160
  +MISSILEMORE
  +DONTHURTSPECIES
  +LOOKALLAROUND
  +FLOORCLIP
  +DONTRIP
  +NORADIUSDMG
  +BOSS
  +NEVERRESPAWN
  +DONTMORPH
  +AMBUSH
  +NOICEDEATH
  Painchance 2
  Seesound ""
  Deathsound "touhou/defeat"
  PainSound "touhou/pain"
  Obituary "%o failed to get out of Marisa's way."
  DropItem "ExMarisaAndromeda"
  States
  {
  Spawn:
	MARI A 0
	MARI A 0 Thing_ChangeTID(0,6241)
	MARI A 1 ACS_NamedExecute("BHI_BossStartAttack",0,6241,4,false)
	MARI A 1 ACS_NamedExecute("BHI_BossStartTimer",0,6241,60)
  Idle:
    MARI BCDEFGHIJA 2 A_Look
    Loop
  See:
    MARI ABCDEFGHIJ 2 A_Chase
    Loop
  Pain:
	MARI A 0 A_SetTranslucent(1.0)
    MARI K 2 A_Pain
    MARI LMLK 2
    Goto See
  Melee:
	MARB A 0 A_Jump(64,"Melee2")
    MARB ABCDE 3
	MARB F 3 A_CustomMeleeAttack(70,"touhou/remi/hit","none")
	MARB HIJK 3
	Goto See
  Melee2:
    MARB LMNOPQR 3
	MARB S 3 A_CustomMeleeAttack(100,"touhou/remi/hit","none")
	MARB TUVWX 3
	Goto See
  Missile:
	MAR1 A 0 A_Jump(255,"Missile1","Missile2","Missile3","Missile4")
	Goto Missile1
  Missile1:
	MAR1 ABCDE 3 A_FaceTarget
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner1LunaticR",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner1LunaticY",0,0,72)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner1LunaticG",0,0,144)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner1LunaticB",0,0,216)
	MAR1 F 3 A_CustomMissile("MarisaNSSpawner1LunaticV",0,0,288)
	MAR1 GFGFGHIJKLM 3 A_FaceTarget
	Goto See
  Missile2:
	MAR1 NOPQR 3 A_FaceTarget
	MAR1 S 0 A_CustomMissile("MarisaNSSpawner2LunaticR",0,0,0)
	MAR1 S 0 A_CustomMissile("MarisaNSSpawner2LunaticY",0,0,0)
	MAR1 S 0 A_CustomMissile("MarisaNSSpawner2LunaticG",0,0,0)
	MAR1 S 0 A_CustomMissile("MarisaNSSpawner2LunaticB",0,0,0)
	MAR1 S 3 A_CustomMissile("MarisaNSSpawner2LunaticV",0,0,0)
	MAR1 TSTSTUVWXYZ 3 A_FaceTarget
	Goto See
  Missile3:
	MAR1 ABCDE 3 A_FaceTarget
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner3Lunatic",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner4Lunatic",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner5Lunatic",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner6Lunatic",0,0,0)
	MAR1 GFGFGHIJKLM 3 A_FaceTarget
	Goto See
  Missile4:
	MAR1 NOPQR 3 A_FaceTarget
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner3Lunatic",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner4Lunatic",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner5Lunatic",0,0,0)
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner6Lunatic",0,0,0)
	MAR1 TSTSTUVWXYZ 3 A_FaceTarget
	Goto See
  MagicMissile:
	MAR1 A 0 A_Jump(128,"MagicMissile2")
	MAR1 ABCD 3 Fast A_FaceTarget
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,27)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,9)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,0)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,-9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,-18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,-27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,-36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,-45)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,-36)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,-27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,-18)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,-9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,0)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,9)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,18)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,27)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,36)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,45)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,27)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,9)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,0)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,-9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,-18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,-27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,-36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile4",32,0,-45)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,-36)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,-27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile4",32,0,-18)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile4",32,0,-9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,0)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,9)
	MAR1 H 1 A_CustomMissile("MarisaMagicMissile4",32,0,18)
	MAR1 H 1 A_CustomMissile("MarisaMagicMissile4",32,0,27)
	MAR1 I 1 A_CustomMissile("MarisaMagicMissile4",32,0,36)
	MAR1 I 1 A_CustomMissile("MarisaMagicMissile4",32,0,45)
	MAR1 JKLM 3 Fast A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  MagicMissile2:
	MAR1 ABCD 3 Fast A_FaceTarget
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,-36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,-27)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,-18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,-9)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,0)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile1",32,0,27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile1",32,0,45)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,36)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,18)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,0)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,-9)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,-18)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile2",32,0,-27)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,-36)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile2",32,0,-45)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,-36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,-27)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,-18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,-9)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,0)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,18)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile3",32,0,27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile3",32,0,36)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile4",32,0,45)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,36)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,27)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile4",32,0,18)
	MAR1 F 1 A_CustomMissile("MarisaMagicMissile4",32,0,9)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,0)
	MAR1 G 1 A_CustomMissile("MarisaMagicMissile4",32,0,-9)
	MAR1 H 1 A_CustomMissile("MarisaMagicMissile4",32,0,-18)
	MAR1 H 1 A_CustomMissile("MarisaMagicMissile4",32,0,-27)
	MAR1 I 1 A_CustomMissile("MarisaMagicMissile4",32,0,-36)
	MAR1 I 1 A_CustomMissile("MarisaMagicMissile4",32,0,-45)
	MAR1 JKLM 3 Fast A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  IllusionLaser:
	MAR1 A 0 A_PlaySound("touhou/charge2",0,1.0,0,1.0)
	MAR1 ABCDE 3 A_FaceTarget
	MAR1 FFFGGGFFFGGGFFFGGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",0,0,0,0,8.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/laser",0,1.0,0,1.0)
	MAR1 A 0 A_CustomRailgun(24,0,"blue","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,8.0,0,"MarisaIllusionLaserTrail",-8)
	MAR1 A 0 A_FaceTarget
	MAR1 FFFGGGFFFGGGFFFGGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",0,0,0,0,8.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/laser",0,1.0,0,1.0)
	MAR1 A 0 A_CustomRailgun(24,0,"blue","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,8.0,0,"MarisaIllusionLaserTrail",-8)
	MAR1 A 0 A_FaceTarget
	MAR1 FFFGGGFFFGGGFFFGGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",0,0,0,0,8.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/laser",0,1.0,0,1.0)
	MAR1 A 0 A_CustomRailgun(24,0,"blue","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,8.0,0,"MarisaIllusionLaserTrail",-8)
	MAR1 A 0 A_FaceTarget
	MAR1 FFFGGGFFFGGGFFFGGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",0,0,0,0,8.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/laser",0,1.0,0,1.0)
	MAR1 A 0 A_CustomRailgun(24,0,"blue","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,8.0,0,"MarisaIllusionLaserTrail",-8)
	MAR1 A 0 A_FaceTarget
	MAR1 FFFGGGFFFGGGFFFGGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",0,0,0,0,8.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/laser",0,1.0,0,1.0)
	MAR1 A 0 A_CustomRailgun(24,0,"blue","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,8.0,0,"MarisaIllusionLaserTrail",-8)
	MAR1 A 0 A_FaceTarget
	MAR1 HIJKLM 3 A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  MeteonicDebris:
	MAR1 A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_STATIC)
	MAR1 NOPQR 3 A_FaceTarget
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 S 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile1",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile2",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 0 A_CustomMissile("MarisaMagicMissile3",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 T 1 A_CustomMissile("MarisaMagicMissile4",32,0,frandom(-27,27),CMF_OFFSETPITCH,frandom(-9,9))
	MAR1 UVWXYZ 3 A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  RadialStrike:
	MARB A 0 A_PlaySound("touhou/spellcard",0,1.0,0,1.0)
	MARB LMNOPQR 3 A_FaceTarget
	MARB S 0 A_CustomMissile("MarisaRadialStrikeSpawner",32,0,0)
	MARB S 1 A_CustomMissile("MarisaRadialStrikeSpawner",32,0,0)
	MARB S 0 A_CustomMissile("MarisaRadialStrikeSpawner",32,0,0)
	MARB S 1 A_CustomMissile("MarisaRadialStrikeSpawner",32,0,0)
	MARB S 0 A_CustomMissile("MarisaRadialStrikeSpawner",32,0,0)
	MARB S 1 A_CustomMissile("MarisaRadialStrikeSpawner",32,0,0)
	MARB TUVWX 3 A_FaceTarget
	MARB A 0 A_Jump(128,"Missile")
	Goto See
  Death:
	MARI K 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	MARI K 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	MARI K 0 A_GiveInventory("BulletDeathTrigger",1)
    MARI K 0 A_NoBlocking
	MARI K 0 A_PlaySound("touhou/nuefire")
	MARI KKKLLLMMM 3 A_FadeOut(0.1)
	Stop
  }
}

ACTOR ExMarisaAndromeda : ExMarisa
{
  +INVULNERABLE
  +NOPAIN
  var int user_angle;
  DropItem "ExMarisaGalacticCannibalism"
  DamageFactor "TouhouHakureiNeedle", 1.2
  States
  {
  Spawn:
    MARI A 0
	MARI A 0 A_SetTranslucent(0.1)
	MARI ABCDEFGHIJ 2 A_FadeIn(0.1)
  Idle:
	MARI ABCDEFGHIJ 2 A_Look
	Goto Idle
  See:
	MAR2 A 0 A_SetTranslucent(1.0,0)
	MAR2 A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    MAR2 ABCDE 4 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6242)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6242,4,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6242,65)
	MAR2 A 0 ACS_Execute(607,0,156)
	MAR2 A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	MAR2 A 0 A_GiveInventory("SpellcardActive",1)
	MAR2 FGFGFGFGFGFG 3 A_FaceTarget
    MAR2 HI 4 A_FaceTarget
	MAR2 A 0 A_UnSetInvulnerable
	TNT1 A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    MARI ABCDEFGHIJ 3 A_Chase
    Loop
  Missile:
	MAR3 ABCDE 3 Fast A_FaceTarget
  MissileLoop:
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+20,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+40,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+60,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+80,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+100,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+120,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+140,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+160,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+180,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+200,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+220,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+240,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+260,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+280,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+300,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+320,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+340,CMF_AIMDIRECTION)
	MAR3 FFF 0 A_CustomMissile("ExMarisaAndromedaYellowStar",32,random(256,768),frandom(-45,45))
	MAR3 FFF 0 A_CustomMissile("MarisaMilkyWayYellowStar",32,random(256,768),frandom(-45,45))
	MAR3 FG 2 Fast A_SetUserVar("user_angle",user_angle+3)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+20,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+40,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+60,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+80,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+100,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+120,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+140,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+160,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+180,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+200,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+220,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+240,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+260,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+280,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+300,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+320,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+340,CMF_AIMDIRECTION)
	MAR3 FFF 0 A_CustomMissile("ExMarisaAndromedaGreenStar",32,random(-768,-256),frandom(-45,45))
	MAR3 FFF 0 A_CustomMissile("MarisaMilkyWayGreenStar",32,random(-768,-256),frandom(-45,45))
	MAR3 FG 2 Fast A_SetUserVar("user_angle",user_angle+4)
	MAR3 F 0 A_MonsterRefire(10,"MissileEnd")
	Loop
  MissileEnd:
	MAR3 HIJ 4 Fast
	Goto See
  Death:
	MARI K 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	MARI K 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	MARI K 0 ACS_Execute(609,0)
	MARI K 0 A_GiveInventory("BulletDeathTrigger",1)
    MARI K 0 A_NoBlocking
	MARI K 0 A_PlaySound("touhou/nuefire")
	MARI KKKLLLMMM 3 A_FadeOut(0.1)
	Stop 
  }
}
ACTOR ExMarisaAndromedaBlueStar
{
  Radius 3
  Height 6
  Speed 20
  FastSpeed 30
  damage (10)
  Projectile
  +FORCEXYBILLBOARD
  DamageType "MarisaDamage"
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit"
  States
  {
  Spawn:
    BST2 A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	Loop
  Death:
    BST2 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR ExMarisaAndromedaRedStar : ExMarisaAndromedaBlueStar
{
  States
  {
  Spawn:
    RST2 A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	Loop
  Death:
    RST2 AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR ExMarisaAndromedaYellowStar
{
  Radius 2
  Height 4
  Speed 10
  FastSpeed 15
  damage (10)
  Projectile
  +FORCEXYBILLBOARD
  DamageType "MarisaDamage"
  RenderStyle Add
  SeeSound "touhou/fire"
  DeathSound "touhou/hit"
  States
  {
  Spawn:
    YSTR A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	Loop
  Death:
    YSTR AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}
ACTOR ExMarisaAndromedaGreenStar : MarisaMilkyWayYellowStar
{
  States
  {
  Spawn:
    GSTR A 1 Bright A_JumpIfInTargetInventory("BulletDeathTrigger",1,"Death")
	Loop
  Death:
    GSTR AAAAAAAAAA 1 Bright A_FadeOut
    Stop
  }
}

ACTOR ExMarisaGalacticCannibalism : ExMarisa
{
  +INVULNERABLE
  +NOPAIN
  var int user_angle;
  DropItem "ExMarisaNS2"
  DamageFactor "TouhouHakureiNeedle", 1.2
  States
  {
  Spawn:
    MARI A 0
	MARI A 0 A_SetTranslucent(0.1)
	MARI ABCDEFGHIJ 2 A_FadeIn(0.1)
  Idle:
	MARI ABCDEFGHIJ 2 A_Look
	Goto Idle
  Pain:
	MAR1 A 0 A_TakeInventory("MarisaSpreadTrigger",1)
	MAR1 A 0 A_TakeInventory("MarisaAimTrigger",1)
	MAR1 A 0 A_TakeInventory("MarisaLaserTrigger",1)
	MARI A 0 A_SetTranslucent(1.0)
    MARI K 2 A_Pain
    MARI LMLK 2
    Goto See
  See:
	MAR2 A 0 A_SetTranslucent(1.0,0)
	MAR2 A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    MAR2 ABCDE 4 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6243)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6243,3,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6243,70)
	MAR2 A 0 ACS_Execute(607,0,157)
	MAR2 A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	MAR2 A 0 A_GiveInventory("SpellcardActive",1)
	MAR2 A 0 A_CustomMissile("MarisaOrreriesSunOrbRed",32,0,0)
	MAR2 A 0 A_CustomMissile("MarisaOrreriesSunOrbBlueL",32,0,60)
	MAR2 A 0 A_CustomMissile("MarisaOrreriesSunOrbGreenL",32,0,120)
	MAR2 A 0 A_CustomMissile("MarisaOrreriesSunOrbYellowL",32,0,180)
	MAR2 A 0 A_CustomMissile("MarisaOrreriesSunOrbVioletL",32,0,240)
	MAR2 A 0 A_CustomMissile("MarisaOrreriesSunOrbOrangeL",32,0,300)
	MAR2 FGFGFGFGFGFG 3 A_FaceTarget
    MAR2 HI 4 A_FaceTarget
	MAR2 A 0 A_UnSetInvulnerable
	TNT1 A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    MARI ABCDEFGHIJ 2 A_Chase
    Loop
  Missile:
	MAR3 ABCDE 3 Fast A_FaceTarget
	MAR3 A 0 A_GiveInventory("MarisaSpreadTrigger",1)
  MissileLoop:
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+22.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+45.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+67.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+90.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+112.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+135.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+157.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+180.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+202.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+225.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+247.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+270.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+292.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+315.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaBlueStar",32,0,user_angle+337.5,CMF_AIMDIRECTION)
	MAR3 FG 3 Fast A_SetUserVar("user_angle",user_angle+4)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+22.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+45.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+67.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+90.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+112.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+135.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+157.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+180.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+202.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+225.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+247.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+270.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+292.5,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+315.0,CMF_AIMDIRECTION)
	MAR3 F 0 A_CustomMissile("ExMarisaAndromedaRedStar",32,0,user_angle+337.5,CMF_AIMDIRECTION)
	MAR3 FG 3 Fast A_SetUserVar("user_angle",user_angle+4)
	MAR3 F 0 A_MonsterRefire(15,"MissileEnd")
	Loop
  MissileEnd:
	MAR3 HIJ 4 Fast
	MAR3 A 0 A_TakeInventory("MarisaSpreadTrigger",1)
	Goto See
  Death:
	MARI K 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	MARI K 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	MARI K 0 ACS_Execute(609,0)
	MARI K 0 A_GiveInventory("BulletDeathTrigger",1)
    MARI K 0 A_NoBlocking
	MARI K 0 A_PlaySound("touhou/nuefire")
	MARI KKKLLLMMM 3 A_FadeOut(0.1)
	Stop
  }
}

ACTOR ExMarisaNS2 : ExMarisa
{
  DropItem "ExMarisaDoubleSpark"
  +NOPAIN
  States
  {
  Spawn:
    MARI A 0
	MARI A 0 A_SetTranslucent(0.1)
	MARI ABCDEFGHIJ 2 A_FadeIn(0.1)
  Idle:
	MARI A 1 Thing_ChangeTID(0,6244)
	MARI A 1 ACS_NamedExecute("BHI_BossStartAttack",0,6244,2,false)
	MARI B 1 ACS_NamedExecute("BHI_BossStartTimer",0,6244,75)
	MARI B 1 A_SetTranslucent(1.0,0)
	MARI CDEFGHIJ 2 A_Look
	Goto Idle
  See:
	MARI A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
	TNT1 A 0 Thing_ChangeTID(0,6244)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6244,2,false)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6244,75)
	MARI A 0 A_SetTranslucent(1.0,0)
	MARI A 0 A_GiveInventory("SpellcardActive")
	MARI A 0 A_UnSetInvulnerable
	TNT1 A 0 A_ChangeFlag("NOPAIN",0)
  ChaseState:
    MARI ABCDEFGHIJ 2 A_Chase
    Loop
  Missile:
	MAR1 A 0 A_Jump(128,"Missile1","Missile2","Missile3","Missile4")
	MAR1 A 0 A_Jump(192,"MagicMissile","IllusionLaser")
	MAR1 A 0 A_Jump(255,"MeteonicDebris","RadialStrike")
	Goto Missile1
  Missile1:
	MAR1 ABCDE 3 Fast A_FaceTarget
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner3Lunatic",0,0,0)
	MAR1 GHIJKLM 3 Fast A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  Missile2:
	MAR1 NOPQR 3 Fast A_FaceTarget
	MAR1 S 0 A_CustomMissile("MarisaNSSpawner4Lunatic",0,0,0)
	MAR1 TUVWXYZ 3 Fast A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  Missile3:
	MAR1 ABCDE 3 Fast A_FaceTarget
	MAR1 F 0 A_CustomMissile("MarisaNSSpawner5Lunatic",0,0,0)
	MAR1 GHIJKLM 3 Fast A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  Missile4:
	MAR1 NOPQR 3 Fast A_FaceTarget
	MAR1 S 0 A_CustomMissile("MarisaNSSpawner6Lunatic",0,0,0)
	MAR1 TUVWXYZ 3 Fast A_FaceTarget
	MAR1 A 0 A_Jump(128,"Missile")
	Goto See
  }
}

ACTOR ExMarisaDoubleSpark : ExMarisa
{
  +INVULNERABLE
  +NOPAIN
  +MISSILEEVENMORE
  var int user_angle;
  var int user_angle1;
  var int user_angle2;
  PainChance "PlayerSpellcard", 255
  DropItem "ExMarisaChaingunSpark"
  DamageFactor "TouhouHakureiNeedle", 1.2
  Health 3000
  States
  {
  Spawn:
    MARI A 0
	MARI A 0 A_SetTranslucent(0.1)
	MARI ABCDEFGHIJ 2 A_FadeIn(0.1)
  Idle:
	MARI ABCDEFGHIJ 2 A_Look
	Goto Idle
  See:
	MAR2 A 0 A_SetTranslucent(1.0,0)
	MAR2 A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
	MAR2 A 0 Thing_ChangeTID(0,6245)
	MAR2 A 0 ACS_Execute(66,0)
    MAR2 ABCDE 4 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6245)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6245,2,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6245,75)
	MAR2 A 0 ACS_Execute(607,0,158)
	MAR2 A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	MAR2 A 0 A_GiveInventory("SpellcardActive",1)
	MAR2 FGFGFGFGFGFG 3 A_FaceTarget
    MAR2 HI 4 A_FaceTarget
	MAR2 A 0 A_UnSetInvulnerable
	TNT1 A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    MARI ABCDEFGHIJ 2 A_Chase
    Loop
  Missile:
	MAR1 A 0 A_SetUserVar("user_angle1",0)
	MAR1 A 0 A_SetUserVar("user_angle2",random(-30,30))
	MAR1 ABCD 3 Fast A_FaceTarget
	MAR1 A 0 A_PlaySound("touhou/charge3",0,1.0,0,ATTN_NONE)
	MAR1 E 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 E 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 E 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 E 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 E 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 E 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 F 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 F 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 F 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 F 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 F 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 F 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 G 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 G 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 G 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 G 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 G 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 G 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 H 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 H 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 I 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 J 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 K 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 K 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 K 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 K 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 K 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 K 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 L 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 L 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 L 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 L 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 L 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 L 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 M 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 M 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 M 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 M 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 M 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MAR1 M 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 Radius_Quake(8,105,0,32,0)
	MARS A 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS B 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS C 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS C 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS C 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS C 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS C 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS C 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS D 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 A_PlaySound("touhou/nuefire",0,1.0,0,0.5)
	MARS E 0 Fast A_CustomRailgun(1000000,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle1,0,0,0,16.0,0,"MarisaMasterSparkTrail",-8)
	MARS E 3 Fast A_CustomRailgun(1000000,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_angle2,0,0,0,16.0,0,"MarisaMasterSparkTrail",-8)
	MARS F 3 Fast A_SpawnItemEx("MarisaMasterSparkHat",0,0,0,0,0,0,0,0,0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS G 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS H 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS I 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS J 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS K 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS L 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS M 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS N 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS O 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS P 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS Q 3 Fast
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	Goto See
  Pain.PlayerSpellcard:
	MARI A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile+42
  Death:
	MARI K 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	MARI K 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	MARI K 0 ACS_Execute(609,0)
	MARI K 0 A_GiveInventory("BulletDeathTrigger",1)
    MARI K 0 A_NoBlocking
	MARI K 0 A_PlaySound("touhou/nuefire")
	MARI KKKLLLMMM 3 A_FadeOut(0.1)
	Stop
  }
}

ACTOR ExMarisaChaingunSpark : ExMarisa
{
  +INVULNERABLE
  +NOPAIN
  +MISSILEEVENMORE
  var int user_angle;
  PainChance "PlayerSpellcard", 255
  DropItem "ExMarisaSSGSpark"
  Health 3000
  DamageFactor "TouhouHakureiNeedle", 1.2
  States
  {
  Spawn:
    MARI A 0
	MARI A 0 A_SetTranslucent(0.1)
	MARI ABCDEFGHIJ 2 A_FadeIn(0.1)
  Idle:
	MARI ABCDEFGHIJ 2 A_Look
	Goto Idle
  See:
	MAR2 A 0 A_SetTranslucent(1.0,0)
	MAR2 A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    MAR2 ABCDE 4 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6246)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6246,1,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6246,75)
	MAR2 A 0 ACS_Execute(607,0,159)
	MAR2 A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	MAR2 A 0 A_GiveInventory("SpellcardActive",1)
	MAR2 FGFGFGFGFGFG 3 A_FaceTarget
    MAR2 HI 4 A_FaceTarget
	MAR2 A 0 A_UnSetInvulnerable
	TNT1 A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  ChaseState:
    MARI ABCDEFGHIJ 2 A_Chase
    Loop
  Missile:
	MAR1 ABCD 2 A_FaceTarget
	MAR1 A 0 A_PlaySound("touhou/charge3",0,1.0,0,ATTN_NONE)
	MAR1 EEFFGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 HHIIJJKKLLMM 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 Radius_Quake(6,35,0,32,0)
	MARS AABBCCDD 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"HarmlessLaserTrail",-8)
  MissileLoop:
	MARS E 0 Fast A_CustomRailgun(1000000,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"MarisaMasterSparkTrail",-8)
	MARS A 0 A_SpidRefire
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 A 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 B 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 B 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 C 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 C 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 D 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 D 1 Fast
	MARS AAA 0 A_CustomMissile("MarisaMasterSparkStar",32,0,random(0,360))
	MARS AAAAAA 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,random(0,360))
	MAR1 A 0 A_PlaySound("touhou/charge3",0,1.0,0,ATTN_NONE)
	MAR1 EEFFGG 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"HarmlessLaserTrail",-8)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 HHIIJJKKLLMM 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"HarmlessLaserTrail",-8)
	MARS A 0 Radius_Quake(6,35,0,32,0)
	MARS AABBCCDD 1 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT,0,0,"BulletPuff",0,0,0,0,24.0,0,"HarmlessLaserTrail",-8)
	Loop
  Pain.PlayerSpellcard:
	MARI A 0 A_ChangeFlag("NOPAIN",0)
	Goto Missile
  Death:
	MARI K 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	MARI K 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	MARI K 0 ACS_Execute(609,0)
	MARI K 0 A_GiveInventory("BulletDeathTrigger",1)
    MARI K 0 A_NoBlocking
	MARI K 0 A_PlaySound("touhou/nuefire")
	MARI KKKLLLMMM 3 A_FadeOut(0.1)
	Stop
  }
}

ACTOR ExMarisaSSGSpark : ExMarisa //Wait what
{
  Health 3000
  +NOPAIN
  +INVULNERABLE
  +MISSILEEVENMORE
  DropItem "StardustReverie"
  DropItem "MasterSpark"
  var int user_count;
  var int user_angle;
  var int user_theta[20];
  var int user_pitch[20];
  DamageFactor "TouhouHakureiNeedle", 1.0
  States
  {
  Spawn:
    MARI A 0
	MARI A 0 A_SetTranslucent(0.1)
	MARI ABCDEFGHIJ 2 A_FadeIn(0.1)
  Idle:
	MARI ABCDEFGHIJ 2 A_Look
	Goto Idle
  See:
	MAR2 A 0 A_SetTranslucent(1.0,0)
	MAR2 A 0 A_JumpIfInventory("SpellcardActive",1,"ChaseState")
    MAR2 ABCDE 4 A_FaceTarget
	TNT1 A 0 Thing_ChangeTID(0,6247)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartAttack",0,6247,0,true)
	TNT1 A 0 ACS_NamedExecute("BHI_BossStartTimer",0,6247,75)
	MAR2 A 0 ACS_Execute(607,0,160)
	MAR2 A 0 A_PlaySound("touhou/spellcard",0,1.0,0,ATTN_NONE)
	MAR2 A 0 A_GiveInventory("SpellcardActive",1)
	MAR2 FGFGFGFGFGFG 3 A_FaceTarget
    MAR2 HI 4 A_FaceTarget
	MAR2 A 0 A_UnSetInvulnerable
  SetupLoop: //A.k.a. for(int user_count = 0; user_count < 20; user_count++)
	MAR1 A 0 A_JumpIf(user_count >= 19, "Missile")
	MAR1 A 0 A_SetUserArray("user_theta",user_count,frandom(-20,20))
	MAR1 A 0 A_SetUserArray("user_pitch",user_count,frandom(-4,5))
	MAR1 A 0 A_SetUserVar("user_count", user_count + 1)
	Loop
  ChaseState:
	MARS A 0 A_SpawnItemEx("DanmakuBrainExploder",0,0,0,0,0,0,0,0,0)
    MARI ABCDEFGHIJ 2 A_Chase
    Loop
  Missile:
	MAR1 ABCD 5 Fast A_FaceTarget
	MAR1 A 0 A_PlaySound("touhou/charge3",0,1.0,0,ATTN_NONE)
	MAR1 A 0 A_SetUserVar("user_count", 0)
  PreLaserLoop: //A.k.a. for(int user_count = 0; user_count < 20; user_count++)
	MAR1 A 0 A_JumpIf(user_count >= 19, "KeepFiring")
	MAR1 A 0 A_SetUserArray("user_theta",user_count,frandom(-20,20))
	MAR1 A 0 A_SetUserArray("user_pitch",user_count,frandom(-4,5))
	MAR1 A 0 A_SetUserVar("user_count", user_count + 1)
	MAR1 A 0 A_CustomRailgun(0,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_theta[user_count],user_pitch[user_count],0,0,32.0,0,"IkuHarmlessLaserTrail",-8)
	Loop
  KeepFiring:
	MAR1 EFG 5 Fast
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 A 0 A_PlaySound("touhou/marisa/spark",0,1.0,0,ATTN_NONE)
	MAR1 HIJKLMN 4 Fast
	MARS A 0 Radius_Quake(9,105,0,64,0)
	MARS ABCD 4 Fast
	MAR1 A 0 A_SetUserVar("user_count", 0)
  FireLaserLoop: //A.k.a. for(int user_count = 0; user_count < 20; user_count++)
	MAR1 A 0 A_JumpIf(user_count >= 19, "EndFire")
	MAR1 A 0 A_SetUserVar("user_count", user_count + 1)
	MAR1 A 0 A_CustomRailgun(1000000,0,"none","white",RGF_SILENT|RGF_FULLBRIGHT|RGF_EXPLICITANGLE,0,0,"BulletPuff",user_theta[user_count],user_pitch[user_count],0,0,32.0,0,"MarisaMasterSparkTrail",-8)
	Loop
  EndFire:
	MARS A 0 A_SpawnItemEx("DanmakuBrainExploder",0,0,0,0,0,0,0,0,0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS GG 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS HH 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS II 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS JJ 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS KK 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS LL 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS MM 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS NN 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS OO 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS PP 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	MARS QQ 2 Fast Thing_Damage(6247, 136, 0)
	MARS A 0 A_SetUserVar("user_angle",random(0,360))
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar",32,0,user_angle+330)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+0)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+30)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+60)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+90)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+120)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+150)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+180)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+210)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+240)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+270)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+300)
	MARS A 0 A_CustomMissile("MarisaMasterSparkStar2",32,0,user_angle+330)
	Goto See
  Death:
	MARI K 1 ACS_NamedTerminate("BHI_BossStartAttack",0)
	MARI K 1 ACS_NamedExecute("BHI_BossStopAttack",0)
	MARI K 0 A_GiveInventory("BulletDeathTrigger",1)
	MARI K 0 ACS_Execute(609,0)
	MARI KLM 18
	TNT1 A 0 A_ScreamAndUnblock
	TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 BRIGHT A_SpawnItemEx("TouhouFireWhite",frandom(4,-4),frandom(4,-4),frandom(4,-4),frandom(8,-8),frandom(8,-8),frandom(8,-8),frandom(0,360),0,0)
	TNT1 A 70
	TNT1 A 1 ACS_Execute(136,0)
	Stop
  }
}